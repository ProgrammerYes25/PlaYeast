<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.hs.study.PlaYeast.Mappers.PlaYeastMapper">
    <insert id="muiscInsert" parameterType="kr.hs.study.PlaYeast.DTO.MusicDTO">
        INSERT INTO music_table(music_id, music_name, music_artist, music_album, music_time, music_track, genre_id, mood_id, weather_id)
        VALUES(NULL, #{music_name}, #{music_artist}, #{music_album}, #{music_time}, #{music_track}, #{genre_id}, #{mood_id}, #{weather_id})
    </insert>
    <select id="allSelect" resultType="kr.hs.study.PlaYeast.DTO.MusicDTO">
        SELECT * FROM music_table ORDER BY music_artist
    </select>
    <select id="nameSelect" parameterType="kr.hs.study.PlaYeast.DTO.SearchDTO" resultType="kr.hs.study.PlaYeast.DTO.MusicDTO">
        SELECT music_track, music_name, music_artist, music_album
        FROM (SELECT music_track, music_name, REGEXP_REPLACE(LOWER(music_name), '\s', ''),
            music_artist, REGEXP_REPLACE(LOWER(music_artist), '\s', ''),
            music_album, REGEXP_REPLACE(LOWER(music_album), '\s', '')
            FROM music_table
            WHERE music_name LIKE '%'||#{name}||'%' OR music_artist LIKE '%'||#{name}||'%' OR music_album LIKE '%'||#{name}||'%')
    </select>
</mapper>